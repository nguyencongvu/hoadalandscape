(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"12a1f":function(t,e,a){},"24b6":function(t,e,a){"use strict";a("f619")},"359f":function(t,e,a){"use strict";a("12a1f")},e9f4:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-layout",[t.c.canAccessModule(t.collection,t.profile.roles)?r("div",{staticClass:"app-padding bg-white"},[r("q-toolbar",[r("div",{staticClass:"text-center q-my-lg"},[r("div",{staticClass:"bold-font text-h5"},[t._v(t._s(t.c.t("Sales Analysis"))+"\n                    "),t.loading?r("q-spinner-pie",{staticClass:"q-ml-sm",attrs:{color:"primary"}}):t._e()],1)]),r("q-space"),r("q-input",{ref:"search",staticClass:"q-mr-sm",staticStyle:{width:"30%"},attrs:{autofocus:"",clearable:"","bg-color":"white",dense:"",outlined:"",placeholder:t.c.t("Search")+"..."},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),r("q-btn",{attrs:{flat:"",round:"",icon:"refresh"},on:{click:function(e){return t.fetch()}}}),t.$q.platform.is.mobile?t._e():r("q-btn",{staticClass:"orientation-landscape",attrs:{flat:"",round:"",icon:"print"}},[r("q-menu",[r("q-list",{staticStyle:{"min-width":"120px"},attrs:{separator:""}},[r("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(e){return t.print("main_table")}}},[t._v("\n                            "+t._s(t.c.t("Print"))+"\n                        ")]),r("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(e){return t.exportCSV()}}},[t._v("\n                            "+t._s(t.c.t("Export CSV"))+"\n                        ")])],1)],1)],1)],1)],1):r("div",[r("div",{staticClass:"absolute-center"},[r("q-img",{attrs:{width:"25vw",src:a("5183")}}),r("div",{staticClass:"text-center q-my-lg"},[t._v(t._s(t.c.t("Access Denied")))])],1)]),r("q-separator",{staticClass:"q-mb-sm"}),r("div",{staticClass:"app-padding"},[r("div",{staticClass:"border-untop bg-white"},[r("div",{staticClass:"row q-col-gutter-sm q-px-sm text-white"},[r("div",{staticClass:"col-6 col-md-2"},[r("Number",{attrs:{propNumber:t.c.sum(t.online,"count"),propText:t.c.formatCurrency(t.c.sum(t.online,"total")),propIcon:"shopping_basket",propColor:"blue-10"}})],1),r("div",{staticClass:"col-6 col-md-2"},[r("Number",{attrs:{propNumber:t.c.sum(t.offline,"count"),propText:t.c.formatCurrency(t.c.sum(t.offline,"total")),propIcon:"store",propColor:"blue-8"}})],1),r("div",{staticClass:"col-6 col-md-2"},[r("Number",{attrs:{propNumber:t.c.sum(t.sales.sales,"total"),propText:t.c.t("Revenue"),propIcon:"paid",propColor:"green-10"}})],1),r("div",{staticClass:"col-6 col-md-2"},[r("Number",{attrs:{propNumber:t.getProfit(t.sales.sales),propText:t.c.t("Profit"),propIcon:"savings",propColor:"green-8"}})],1),r("div",{staticClass:"col-6 col-md-2"},[r("Number",{attrs:{propNumber:t.c.sum(t.offlineContacts,"count"),propText:t.c.t("Contacts"),propIcon:"emoji_people",propColor:"orange-10"}})],1),r("div",{staticClass:"col-6 col-md-2"},[r("Number",{attrs:{propNumber:t.c.sum(t.onlineContacts,"count"),propText:t.c.t("Contacts"),propIcon:"contact_mail",propColor:"orange-8"}})],1)]),r("div",{staticClass:"row q-col-gutter-sm q-py-sm"},[r("div",{staticClass:"col-12 col-md-6"},[r("q-card",{staticClass:"q-ml-sm"},[r("DataTable",{attrs:{propCollection:t.collection,propData:t.fsearch,propColumns:t.columns,propVisibleColumns:t.visibleColumns,propRowKey:"id"},on:{reload:function(e){return t.fetch("sales")}}}),r("PrintCreator")],1)],1),r("div",{staticClass:"col-12 col-md-6"},[r("q-card",{staticClass:"q-pa-sm q-mr-sm"},[r("div",{staticClass:"row q-col-gutter-sm"},[r("div",{staticClass:"col-12 col-md-9"},[r("Chart",{attrs:{propType:"pie",propLegend:t.chart.legend,propData:t.chart.data}})],1)])])],1)])])])],1)},n=[],o=a("c973"),i=a.n(o),l=(a("96cf"),a("4de4"),a("caad"),a("2532"),a("e260"),a("d3b7"),a("e6cf"),a("3ca3"),a("ddb0"),a("bd4c")),s=a("e19d"),c=a("0d2f"),p=a("1a89"),u=a("2d2e"),f=a("1fdb"),m=a("2c55"),d=a("4ea3"),b=a("f18f"),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-chart",{staticClass:"chart",attrs:{option:t.option}})},g=[],C=a("9523"),v=a.n(C),w=(a("b680"),a("b0c0"),a("22b4")),y=a("97ac"),x=a("49bb"),D=a("4cb5"),_=a("9394"),L=a("2da7"),q=a("ff32"),T=a("5c7f");Object(w["a"])([y["a"],x["a"],D["a"],_["a"],L["a"],q["a"]]);var S={name:"Chart",props:{propName:String,propType:String,propLegend:Array,propData:Array},components:{VChart:T["b"]},provide:v()({},T["a"],"light"),data:function(){return{c:this.$common,rootValue:this.propData[0].value,option:{},chartName:this.propName?this.propName:"Chart",chartType:this.propType?this.propType:"pie",chartLegend:this.propLegend?this.propLegend:[],chartData:this.propData?this.propData:[]}},created:function(){this.init()},methods:{init:function(){this.chartLegend=this.propLegend?this.propLegend:["top","middle","bottom"],this.chartData=this.propData?this.propData:[{value:1e3,name:"top"},{value:500,name:"middle"}],this.initOption()},initOption:function(){var t=this;t.option={tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c}"},legend:{data:t.chartLegend},series:[{name:t.chartName,type:t.chartType,data:t.chartData,radius:[20,140],roseType:"area",label:{show:!0,position:"inside",formatter:function(e){var a=(e.value/t.rootValue*100).toFixed(2);return e.name+"\n"+e.value+" ("+a+"%) "}},emphasis:{label:{fontSize:20}}}]}}}},N=S,Q=(a("24b6"),a("2877")),O=Object(Q["a"])(N,h,g,!1,null,"a1581b8c",null),$=O.exports,k={name:"ListAll",components:{TimeRange:s["default"],PrintCreator:c["a"],ViewLayout:p["a"],FilterBy:u["default"],DataTable:f["default"],DataCard:m["a"],Comment:d["a"],Number:b["a"],Chart:$},data:function(){return{loading:!1,c:this.$common,api:null,collection:"analytics/sales",showSearch:!1,text:"",objects:[],webObjects:[],sales:{},selected:{},columns:[],visibleColumns:[],timeFilter:null,viewLayout:"table",filters:[],filterText:"",stats:!0,tab:"2",comments:[],funnel:{},chart:{},newMax:4e3,expense:5e5,perLead:0,online:[],offline:[],onlineContacts:[],offlineContast:[]}},computed:{profile:function(){return this.$store.state.user.profile},fsearch:function(){var t=this,e=[];if(e=t.sales.so,t.timeFilter){var a=t.timeFilter,r=new Date(a.from),n=new Date(a.to);e=e.filter((function(t){return l["b"].isBetweenDates(t.first_date,r,n)}))}t.filterText&&""!=t.filterText&&(e=e.filter((function(e){var a=t.filterText.toLowerCase(),r=e.type?e.type.toLowerCase():"",n=e.status?e.status.toLowerCase():"",o=e.category?e.category.toLowerCase():"",i=e.group?e.group.toLowerCase():"";return r==a||n==a||o==a||i==a})));var o=t.text?t.text.toLowerCase():"";return""==o?e:e.filter((function(t){var e=t.title?t.title.toLowerCase():"",a=t.type?t.type.toLowerCase():"",r=t.code?t.code.toLowerCase():"";return e.includes(o)||a.includes(o)||r.includes(o)}))},leads:function(){var t=this;return t.sales.contacts?t.sales.contacts.filter((function(t){return"online"==t.type})):[]}},created:function(){this.init()},methods:{init:function(){var t=this;return i()(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,a.api=new a.$api(a.collection),a.api.setDomain(a.profile.domain),a.newMax=1e3,a.initFilter(),e.next=7,a.fetch();case 7:case"end":return e.stop()}}),e)})))()},initChart:function(t){var e=this;e.chart={legend:[e.c.t("Offline"),e.c.t("Online")],data:[{value:e.c.sum(e.offline,"total"),name:e.c.t("Offline")},{value:e.c.sum(e.online,"total"),name:e.c.t("Online")}]}},initColumns:function(){var t=this;t.columns=[{name:"recent",align:"left",label:t.c.t("Recent"),field:"date_updated",format:function(e){return t.c.dateDiff(new Date,new Date(e))},sortable:!0},{name:"id",align:"left",label:t.c.t("ID"),field:function(t){return t.id},sortable:!0},{name:"code",align:"left",label:t.c.t("SO Code"),field:function(t){return t.code},sortable:!0},{name:"title",align:"left",label:t.c.t("Title"),field:function(t){return t.title},sortable:!0},{name:"slug",align:"left",label:t.c.t("Slug"),field:function(t){return t.slug},sortable:!0},{name:"type",align:"left",label:t.c.t("Type"),field:"type",sortable:!0},{name:"category",align:"left",label:t.c.t("Category"),field:"category",sortable:!0},{name:"groupname",align:"left",label:t.c.t("Group name"),field:"groupname",sortable:!0},{name:"total",align:"right",label:t.c.t("Total"),field:"total",format:function(e){return t.c.formatCurrency(e)},sortable:!0},{name:"cog",align:"right",label:t.c.t("Cost of goods"),field:"cog",format:function(e){return t.c.formatCurrency(e)},sortable:!0},{name:"profit",align:"right",label:t.c.t("Profit"),field:function(t){return t.total-t.cog},format:function(e){return t.c.formatCurrency(e)},sortable:!0},{name:"status",align:"left",label:t.c.t("Status"),field:"status",sortable:!0},{name:"contact_id",align:"left",label:t.c.t("Contact Code"),field:"contact_id",sortable:!0},{name:"contact_name",align:"left",label:t.c.t("Contact Name"),field:"contact_name",sortable:!0},{name:"summary",align:"left",label:t.c.t("Summary"),field:"summary",sortable:!0},{name:"source",align:"left",label:t.c.t("Source"),field:"source",sortable:!0},{name:"images",align:"left",label:t.c.t("Images"),field:"images",sortable:!0},{name:"owner",align:"left",label:t.c.t("Owner"),field:"owner",sortable:!0},{name:"date_start",align:"left",label:t.c.t("Date Start"),field:"date_start",format:function(e){return t.c.formatDataDate(e)},sortable:!0},{name:"date_end",align:"left",label:t.c.t("Date End"),field:"date_end",format:function(e){return t.c.formatDataDate(e)},sortable:!0},{name:"date_created",align:"left",label:t.c.t("Date Created"),field:"date_created",format:function(e){return t.c.formatDataDate(e)},sortable:!0},{name:"date_updated",align:"left",label:t.c.t("Date Updated"),field:"date_updated",format:function(e){return t.c.formatDataDate(e)},sortable:!0}],t.visibleColumns=["recent","code","type","total","profit","status","contact_name","owner"]},fetch:function(){var t=this;return i()(regeneratorRuntime.mark((function e(){var a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,a.loading=!0,e.next=4,a.api.getAll(a.collection);case 4:return r=e.sent,n=[r],e.next=8,Promise.all(n);case 8:a.sales=r.data,a.online=a.sales.sales.filter((function(t){return t.type&&"online"==t.type.toLowerCase()})),a.offline=a.sales.sales.filter((function(t){return!t.type||"online"!=t.type.toLowerCase()})),a.onlineContacts=a.sales.contacts.filter((function(t){return t.type&&"online"==t.type.toLowerCase()})),a.offlineContacts=a.sales.contacts.filter((function(t){return!t.type||"online"!=t.type.toLowerCase()})),a.objects=a.sales.so,console.log(""),a.initColumns(),a.initChart(a.sales.so),a.loading=!1;case 18:case"end":return e.stop()}}),e)})))()},initFilter:function(){var t=this;t.filters=[]},getProfit:function(t){return this.c.sum(t,"total")-this.c.sum(t,"cog")},filterTime:function(t){var e=this;e.timeFilter=t,e.$forceUpdate()},fillViewLayout:function(t){var e=this;e.viewLayout=t.value,e.$forceUpdate()},fillFilter:function(t){var e=this;e.filterText=t,e.$forceUpdate()},fillComment:function(t){var e=this;e.comments=t,e.$forceUpdate()},print:function(t){var e=this.$refs[t];e&&this.c.print(e)},exportCSV:function(){var t=this;t.c.exportCSV(t.fsearch,t.columns,t.collection)}}},I=k,V=(a("359f"),a("4d5a")),F=a("068f"),P=a("65c6"),R=a("58a8"),j=a("163c"),A=a("2c91"),U=a("27f9"),B=a("9c40"),E=a("4e73"),M=a("1c1c"),J=a("66e5"),z=a("ddd8"),G=a("eb85"),K=a("9564"),H=a("f09f"),W=a("714f"),X=a("eebe"),Y=a.n(X),Z=Object(Q["a"])(I,r,n,!1,null,"12f8f607",null);e["default"]=Z.exports;Y()(Z,"components",{QLayout:V["a"],QImg:F["a"],QToolbar:P["a"],QBadge:R["a"],QSpinnerPie:j["a"],QSpace:A["a"],QInput:U["a"],QBtn:B["a"],QMenu:E["a"],QList:M["a"],QItem:J["a"],QSelect:z["a"],QSeparator:G["a"],QToggle:K["a"],QCard:H["a"]}),Y()(Z,"directives",{Ripple:W["a"]})},f619:function(t,e,a){}}]);