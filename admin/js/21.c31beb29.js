(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[21],{"0b68":function(t,e,s){"use strict";s("c8bac")},c8bac:function(t,e,s){},e247:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.cart&&t.cart.length<=0?a("div",{staticClass:"text-center",staticStyle:{"margin-top":"50%"}},[a("q-img",{attrs:{width:"40%",ratio:16/9,src:s("8479")}}),a("div",{staticClass:"text-caption q-mt-md"},[t._v(t._s(t.c.t("No data")))])],1):a("q-stepper",{ref:"stepper",style:t.c.isMobile()?"max-height:82vh":"",attrs:{flat:"",color:"primary","header-class":"desktop-hide mobile-hide",infinite:"","header-nav":"",animated:""},scopedSlots:t._u([{key:"navigation",fn:function(){return[t.cart&&t.cart.length>0?a("q-stepper-navigation",[a("q-toolbar",{staticClass:"no-padding q-gutter-xs"},[t.step>1?a("q-btn",{staticClass:"q-mr-sm",attrs:{outline:"",round:"",color:"primary",icon:"chevron_left"},on:{click:function(e){return t.$refs.stepper.previous()}}}):t._e(),a("q-btn",{attrs:{outline:"",round:"",icon:"chevron_right",color:"primary"},on:{click:function(e){return t.$refs.stepper.next()}}}),t.guest.name&&t.guest.phone&&"temp"==t.status?a("q-btn",{staticClass:"q-ml-sm",attrs:{push:"",icon:"save",color:"grey"},on:{click:function(e){return t.saveTemp()}}},[a("q-tooltip",[t._v("Lưu tạm")])],1):t._e(),t.guest.name&&t.guest.phone&&"temp"==t.status?a("q-btn",{staticClass:"q-ml-sm",attrs:{push:"",color:"grey",icon:"print"},on:{click:function(e){return t.print("print-area")}}},[a("q-tooltip",[t._v("In tạm")])],1):t._e(),"ok"==t.status?a("q-btn",{staticClass:"q-ml-sm",attrs:{push:"",color:"primary",icon:"save"},on:{click:function(e){t.status="ok",t.make_order()}}},[a("q-tooltip",[t._v("Lưu chính thức")])],1):t._e(),"ok"==t.status?a("q-btn",{attrs:{push:"",color:"primary",icon:"print"},on:{click:function(e){return t.print("print-area")}}},[a("q-tooltip",[t._v("In chính thức")])],1):t._e(),a("q-space"),a("div",[a("div",{staticClass:"text-right"},[t._v(t._s(t.stepInfo(t.step))+" ")]),a("div",{staticClass:"text-h4 orientation-landscape bold-font q-ml-sm"},[t._v(t._s(t.c.formatCurrency(t.getTotal())))]),a("div",{staticClass:"text-h6 orientation-portrait bold-font q-ml-sm"},[t._v(t._s(t.c.formatCurrency(t.getTotal())))])])],1)],1):t._e()]},proxy:!0}]),model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[a("q-step",{attrs:{name:1,title:t.c.t("Sales Order"),icon:"shopping_basket",done:t.step>1}},[a("q-scroll-area",{style:t.c.isMobile()?"height:58vh; max-height:58vh;":"height:80vh; max-height:80vh;"},[a("div",[a("div",{staticClass:"text-h5 bold-font q-my-md"},[t._v(t._s(t.c.t("Sales Order")))]),a("table",{staticClass:"text-caption no-padding"},[a("thead",{staticStyle:{"border-bottom":"solid 1px #eee","border-top":"solid 1px #eee"}},[a("tr",{staticClass:"bg-grey-2"},[a("th",[t._v("\n                                    "+t._s(t.c.t("Product"))+"\n                                    "),a("q-badge",{attrs:{color:"primary",align:"top"}},[t._v("\n                                        "+t._s(t.cart.length)+"\n                                    ")])],1),a("th",{staticClass:"text-center"},[t._v(t._s(t.c.t("Quantity"))+" "),a("q-badge",{attrs:{color:"primary",align:"top"}},[t._v("\n                                        "+t._s(t.c.sum(t.cart,"quantity")))])],1),a("th",{staticClass:"text-right"},[t._v(t._s(t.c.t("Amount")))]),a("th")])]),a("tbody",t._l(t.cart,(function(e,s){return a("tr",{key:"item"+s},[a("td",{staticClass:"text-caption"},[t._v("\n                                    "+t._s(e.title)+"\n                                    "),a("div",{staticClass:"text-caption"},[t._v(t._s(e.sku))])]),a("td",[a("q-toolbar",{staticClass:"cursor-pointer",staticStyle:{width:"120px",margin:"0 auto"}},[a("q-icon",{attrs:{size:"md",color:"primary",name:"remove_circle_outline",clickable:""},on:{click:function(s){return t.setQuantity(e._id,-1)}}}),a("q-input",{attrs:{flat:"",borderless:"","input-class":"text-bold text-center"},model:{value:e.quantity,callback:function(s){t.$set(e,"quantity",s)},expression:"one.quantity"}}),a("q-icon",{attrs:{size:"md",color:"primary",name:"add_circle_outline",clickable:""},on:{click:function(s){return t.setQuantity(e._id,1)}}})],1)],1),a("td",{staticClass:"text-right text-caption"},[t._v("\n                                    "+t._s(t.c.formatCurrency(e.price*e.quantity))+"\n                                ")]),a("td",[a("q-btn",{attrs:{flat:"",round:"",dense:"","stack-label":"",color:"grey",icon:"delete_outline"},on:{click:function(s){return t.removeItem(e._id)}}})],1)])})),0)])])])],1),a("q-step",{attrs:{name:2,title:t.c.t("Customer"),icon:"person",done:t.step>2}},[a("q-scroll-area",{style:t.c.isMobile()?"height:58vh; max-height:58vh;":"height:80vh; max-height:80vh;"},[a("div",[a("q-toolbar",{staticClass:"no-padding"},[a("div",{staticClass:"text-h5 bold-font q-my-md"},[t._v(t._s(t.c.t("Customer")))]),a("q-space"),a("q-input",{ref:"guestPhone",staticClass:"col-6 col-md-3",attrs:{outlined:"",dense:"","stack-label":"",label:t.c.t("Member Code"),id:"guestPhone",autocomplete:"off"},on:{keyup:function(e){return t.getLeadByPhone(t.memberCode)}},model:{value:t.memberCode,callback:function(e){t.memberCode=e},expression:"memberCode"}},[t.lead.length>0?a("q-menu",{model:{value:t.showLeads,callback:function(e){t.showLeads=e},expression:"showLeads"}},[a("q-list",{attrs:{dense:"","stack-label":""}},t._l(t.lead,(function(e,s){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:"lead"+s,attrs:{clickable:""},on:{click:function(s){return t.setGuest(e)}}},[a("q-item-section",[t._v("\n                                            "+t._s(e.name)+"\n                                        ")]),a("q-item-section",{attrs:{side:"",middle:""}},[t._v("\n                                            "+t._s(e.phone)+"\n                                        ")])],1)})),1)],1):t._e()],1)],1),a("q-form",{staticClass:"row q-col-gutter-xs",on:{reset:t.reset}},[a("q-input",{staticClass:"col-12 col-md-6",attrs:{filled:"",dense:"","stack-label":"",label:t.c.t("Name")+"*"},model:{value:t.guest.name,callback:function(e){t.$set(t.guest,"name",e)},expression:"guest.name"}}),a("q-input",{staticClass:"col-12 col-md-6",attrs:{filled:"",dense:"","stack-label":"",autocomplete:"off",label:t.c.t("Phone")+"*"},model:{value:t.guest.phone,callback:function(e){t.$set(t.guest,"phone",e)},expression:"guest.phone"}}),a("q-input",{staticClass:"col-12 col-md-6",attrs:{filled:"",dense:"","stack-label":"",autocomplete:"off",label:t.c.t("Email")+"*"},model:{value:t.guest.email,callback:function(e){t.$set(t.guest,"email",e)},expression:"guest.email"}}),a("q-input",{staticClass:"col-12 col-md-6",attrs:{filled:"",dense:"","stack-label":"",label:t.c.t("Province")+"*"},model:{value:t.guest.province,callback:function(e){t.$set(t.guest,"province",e)},expression:"guest.province"}}),a("q-input",{staticClass:"col-12 col-md-12",attrs:{filled:"",dense:"","stack-label":"",label:t.c.t("Address")},model:{value:t.guest.address,callback:function(e){t.$set(t.guest,"address",e)},expression:"guest.address"}}),a("q-input",{staticClass:"col-12 col-md-12",attrs:{filled:"",dense:"","stack-label":"",type:"textarea",rows:"2",label:t.c.t("Delivery note")},model:{value:t.guest.first_request,callback:function(e){t.$set(t.guest,"first_request",e)},expression:"guest.first_request"}}),t.memberCode?a("q-input",{staticClass:"col-12 col-md-6",attrs:{filled:"",dense:"","stack-label":"",label:t.c.t("Member Code"),readonly:""},model:{value:t.guest.code,callback:function(e){t.$set(t.guest,"code",e)},expression:"guest.code"}}):t._e(),t.memberCode?a("q-input",{staticClass:"col-12 col-md-6",attrs:{filled:"",dense:"","stack-label":"",type:"number",label:t.c.t("Your coins"),readonly:""},model:{value:t.guest.coins,callback:function(e){t.$set(t.guest,"coins",e)},expression:"guest.coins"}}):t._e(),t.memberCode?a("div",{staticClass:"col-12 col-md-12"},[a("div",{staticClass:"text-h5 bold-font q-my-md"},[t._v(t._s(t.c.t("Membership")))]),a("div",{staticClass:"row q-col-gutter-sm"},[a("q-input",{staticClass:"col-12 col-md-6",attrs:{filled:"",dense:"","stack-label":"",label:t.c.t("Coupon")},model:{value:t.coupon,callback:function(e){t.coupon=e},expression:"coupon"}}),t.guest.coins?a("q-input",{ref:"coinSubtract",staticClass:"col-12 col-md-6",attrs:{type:"number",max:t.guest.coins,filled:"",dense:"","stack-label":"",label:t.c.t("Use coins")},on:{change:function(e){return t.checkCoins()}},model:{value:t.coinSubtract,callback:function(e){t.coinSubtract=t._n(e)},expression:"coinSubtract"}}):t._e()],1)]):t._e(),a("div",{staticClass:"col-12 col-md-12"},[a("div",{staticClass:"text-h5 bold-font q-my-md"},[t._v(t._s(t.c.t("Shipping and Tax")))]),a("div",{staticClass:"row q-col-gutter-sm"},[a("q-input",{staticClass:"col-12 col-md-6",attrs:{filled:"",dense:"","stack-label":"",label:t.c.t("Shipping Fee")+" (đ)"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-btn",{attrs:{flat:"",round:"",color:"primary",icon:"location_on"}})]},proxy:!0}]),model:{value:t.shippingPrice,callback:function(e){t.shippingPrice=t._n(e)},expression:"shippingPrice"}}),a("q-select",{staticClass:"col-12 col-md-6",attrs:{dense:"",filled:"","stack-label":"",options:t.tax,label:t.c.t("Tax")+" (%)"},model:{value:t.taxValue,callback:function(e){t.taxValue=e},expression:"taxValue"}})],1)])],1)],1)])],1),a("q-step",{attrs:{name:3,title:"Thanh toán",icon:"paid"}},[a("q-scroll-area",{style:t.c.isMobile()?"height:58vh; max-height:58vh;":"height:80vh; max-height:80vh;"},[a("div",{staticClass:"relative-position"},[a("div",[a("div",{staticClass:"q-mb-md",staticStyle:{width:"60%",float:"left"}},[a("span",{staticClass:"text-h5 bold-font"},[t._v("Phiếu thanh toán")]),a("br"),t._v("\n                            Khách hàng : "+t._s(t.guest.name)+" "),a("br"),t._v("\n                            Phone : "+t._s(t.guest.phone)+" "+t._s(t.guest.email?" - Email: "+t.guest.email:"")),a("br"),t._v("\n                            Địa chỉ: "+t._s(t.guest.address)+" "+t._s(t.guest.province?", "+t.guest.province:"")+"\n                        ")]),a("div",{staticStyle:{width:"30%",float:"right","text-align":"right"}},[a("b",[t._v(t._s(t.site.site_name))]),a("br"),t._v("\n                            "+t._s(t.site.company_name?t.site.company_name:"")),a("br"),t._v("\n                            "+t._s(t.site.company_taxcode?"MST: "+t.site.company_taxcode:"")),a("br"),t._v("\n                            "+t._s(t.site.company_address?"Địa chỉ: "+t.site.company_address:"")+"\n                        ")]),a("div",{staticStyle:{clear:"both"}}),a("table",{staticClass:"table text-caption no-padding"},[a("thead",{staticStyle:{"border-bottom":"solid 1px #eee","border-top":"solid 1px #eee"}},[a("tr",{staticClass:"bg-grey-2"},[a("th",[t._v("Sản phẩm")]),a("th",{staticStyle:{"text-align":"center"}},[t._v("Số lượng")]),a("th",{staticStyle:{"text-align":"right"}},[t._v("Thành tiền")])])]),a("tbody",[t._l(t.cart,(function(e,s){return a("tr",{key:s},[a("td",{staticClass:"text-caption"},[t._v("\n                                        "+t._s(e.title)+"\n                                    ")]),a("td",{staticClass:"text-center",staticStyle:{"text-align":"center"}},[t._v("\n                                        "+t._s(e.quantity)+"\n                                    ")]),a("td",{staticClass:"text-right text-caption",staticStyle:{"text-align":"right"}},[t._v("\n                                        "+t._s(t.c.formatCurrency(e.price*e.quantity))+"\n                                    ")])])})),t.taxValue?a("tr",[a("td",{staticClass:"text-caption",attrs:{colspan:"2"}},[t._v("+ Thuế VAT (đ)")]),a("td",{staticClass:"text-caption text-right",staticStyle:{"text-align":"right"}},[t._v(t._s(t.c.formatCurrency(t.taxValue*t.getSubTotal()/100))+"\n                                    ")])]):t._e(),t.shippingPrice?a("tr",[a("td",{staticClass:"text-caption",attrs:{colspan:"2"}},[t._v("+ Phí vận chuyển (đ)")]),a("td",{staticClass:"text-caption text-right",staticStyle:{"text-align":"right"}},[t._v(t._s(t.c.formatCurrency(t.shippingPrice)))])]):t._e(),t.discount>0?a("tr",[a("td",{staticClass:"text-caption"},[t._v("- Coupon "+t._s(t.coupon)+" Giảm\n                                        giá\n                                        (đ)")]),a("td",{staticClass:"text-center",staticStyle:{"text-align":"center"}},[t._v("\n                                        "+t._s(t.discountPer)+"%\n                                    ")]),a("td",{staticClass:"text-caption text-right",staticStyle:{"text-align":"right"}},[t._v(t._s(t.c.formatCurrency(t.discount))+"\n                                    ")])]):t._e(),t.coinSubtract>0?a("tr",{staticStyle:{"text-align":"right"}},[a("td",{staticClass:"text-caption"},[t._v("- Sử dụng "+t._s(t.coinSubtract)+" xu\n                                        (đ)")]),a("td",{staticClass:"text-center",staticStyle:{"text-align":"center"}},[t._v("\n                                        "+t._s(t.coinSubtract)+"\n                                    ")]),a("td",{staticClass:"text-caption text-right",staticStyle:{"text-align":"right"}},[t._v(t._s(t.c.formatCurrency(1e3*t.coinSubtract)))])]):t._e(),a("tr",{staticClass:"bg-grey-1"},[a("td",{staticClass:"text-body2 text-bold",attrs:{colspan:"2"}},[t._v("Tổng cộng (đ)")]),a("td",{staticClass:"text-body2 text-bold text-right",staticStyle:{"text-align":"right"}},[t._v(" "+t._s(t.c.formatCurrency(t.total))+"\n                                    ")])])],2)]),a("div",{staticClass:"q-my-sm text-right"},[t._v(t._s(t.c.t("Earn coins"))+": "),a("b",[t._v(t._s(t.coinAdd))])])])])])],1)],1),a("q-dialog",{attrs:{position:"bottom"},model:{value:t.showErrorInputs,callback:function(e){t.showErrorInputs=e},expression:"showErrorInputs"}},[a("q-card",{staticStyle:{width:"350px"}},[a("q-linear-progress",{attrs:{value:1,color:"negative"}}),a("q-card-section",{staticClass:"row items-center no-wrap"},[a("div",t._l(t.errorInputs,(function(e,s){return a("div",{key:s,staticClass:"text-weight-bold"},[t._v("\n                        "+t._s(s+1)+". "+t._s(e)+"\n                    ")])})),0),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",icon:"close"},on:{click:function(e){t.errorInputs=[]}}})],1)],1)],1),a("div",{ref:"print-area",staticClass:"print-only"},[a("div",{staticStyle:{width:"60%",float:"left"}},[a("span",{staticClass:"text-body2 text-bold"},[t._v("PHIẾU THANH TOÁN")]),t._v("\n             "),"temp"==t.status?a("span",[t._v("(In tạm)")]):t._e(),a("br"),t._v("\n            Khách hàng : "+t._s(t.guest.name)+" "),a("br"),t._v("\n            Phone : "+t._s(t.guest.phone)+" "+t._s(t.guest.email?" - Email: "+t.guest.email:"")),a("br"),t._v("\n            Địa chỉ: "+t._s(t.guest.address)+" "+t._s(t.guest.province?", "+t.guest.province:"")+"\n        ")]),a("div",{staticStyle:{width:"30%",float:"right","text-align":"right"}},[a("b",[t._v(t._s(t.site.site_name))]),a("br"),t._v("\n            "+t._s(t.site.company_name?t.site.company_name:"")),a("br"),t._v("\n            "+t._s(t.site.company_taxcode?"MST: "+t.site.company_taxcode:"")),a("br"),t._v("\n            "+t._s(t.site.company_address?"Địa chỉ: "+t.site.company_address:"")+"\n        ")]),a("div",{staticStyle:{clear:"both"}}),a("table",{staticClass:"table text-caption no-padding"},[t._m(0),a("tbody",[t._l(t.cart,(function(e,s){return a("tr",{key:s},[a("td",{staticClass:"text-caption"},[t._v("\n                        "+t._s(e.title)+"\n                    ")]),a("td",{staticClass:"text-center",staticStyle:{"text-align":"center"}},[t._v("\n                        "+t._s(e.quantity)+"\n                    ")]),a("td",{staticClass:"text-right text-caption",staticStyle:{"text-align":"right"}},[t._v("\n                        "+t._s(t.c.formatCurrency(e.price*e.quantity))+"\n                    ")])])})),t.taxValue?a("tr",[a("td",{staticClass:"text-caption",attrs:{colspan:"2"}},[t._v("+ Thuế VAT (đ)")]),a("td",{staticClass:"text-caption text-right",staticStyle:{"text-align":"right"}},[t._v(t._s(t.c.formatCurrency(t.taxValue*t.subTotal/100))+"\n                    ")])]):t._e(),t.shippingPrice?a("tr",[a("td",{staticClass:"text-caption",attrs:{colspan:"2"}},[t._v("+ Phí vận chuyển (đ)")]),a("td",{staticClass:"text-caption text-right",staticStyle:{"text-align":"right"}},[t._v(t._s(t.c.formatCurrency(t.shippingPrice)))])]):t._e(),t.discount>0?a("tr",[a("td",{staticClass:"text-caption"},[t._v("- Coupon "+t._s(t.coupon)+" Giảm\n                        giá\n                        (đ)")]),a("td",{staticClass:"text-center",staticStyle:{"text-align":"center"}},[t._v("\n                        "+t._s(t.discount)+"%\n                    ")]),a("td",{staticClass:"text-caption text-right",staticStyle:{"text-align":"right"}},[t._v(t._s(t.c.formatCurrency(t.discount))+"\n                    ")])]):t._e(),t.coinSubtract>0?a("tr",{staticStyle:{"text-align":"right"}},[a("td",{staticClass:"text-caption"},[t._v("- Sử dụng "+t._s(t.coinSubtract)+" xu\n                        (đ)")]),a("td",{staticClass:"text-center",staticStyle:{"text-align":"center"}},[t._v("\n                        "+t._s(t.coinSubtract)+"\n                    ")]),a("td",{staticClass:"text-caption text-right",staticStyle:{"text-align":"right"}},[t._v(t._s(t.c.formatCurrency(1e3*t.coinSubtract)))])]):t._e(),a("tr",{staticClass:"bg-grey-1"},[a("td",{staticClass:"text-body2 text-bold",attrs:{colspan:"2"}},[t._v("Tổng cộng (đ)")]),a("td",{staticClass:"text-body2 text-bold text-right",staticStyle:{"text-align":"right"}},[t._v(" "+t._s(t.c.formatCurrency(t.total))+"\n                    ")])])],2)]),a("div",{staticClass:"q-my-sm text-right"},[t._v(t._s(t.c.t("Earn coins"))+": "),a("b",[t._v(t._s(t.coinAdd))])]),a("div",{staticClass:"text-right",staticStyle:{"padding-bottom":"3.5rem"}},[t._v("\n            Ngày: "+t._s(t.c.formatDate(new Date))+"\n            "),a("br"),t._v("Người in\n        ")]),t.api.PLAN<2?a("div",{staticClass:"text-center text-caption"},[a("q-separator"),t._v("\n            In từ hệ thống phần mềm POS của công ty Hitime - Website:\n            http://pos.hitime.vn\n        ")],1):t._e()])],1)},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",{staticStyle:{"border-bottom":"solid 1px #eee","border-top":"solid 1px #eee"}},[s("tr",{staticClass:"bg-grey-2"},[s("th",[t._v("Sản phẩm")]),s("th",{staticStyle:{"text-align":"center"}},[t._v("Số lượng")]),s("th",{staticStyle:{"text-align":"right"}},[t._v("Thành tiền")])])])}],i=s("c973"),c=s.n(i),o=s("9523"),r=s.n(o),l=(s("96cf"),s("d81d"),s("ac1f"),s("1276"),s("4de4"),s("c740"),s("13d5"),s("b0c0"),s("caad"),s("2532"),s("7db0"),s("9f7a")),u=s("d443"),d=s("716b"),p={name:"UpsertSelected",components:{Dot:l["default"],Upload:u["a"],Money:d["Money"]},props:{propCart:Array,propGuest:Object},data:function(){var t;return t={loading:!1,c:this.$common,api:null,id:null,collection:"product",objects:[],selected:{},tab:"1",fillToInput:"",inputs:[],fields:[],showMore:!1,errorInputs:[],showErrorInputs:!1,money:{decimal:",",thousands:".",suffix:" đ",precision:0,masked:!1},step:1,filter:"",site:{},guest:{},quantity:1,cart:[],item:{},aff:"online",subTotal:0,total:0,cog:0,profit:0,shippingPrice:0,taxValue:0,memberId:"",coupon:"",coin:0,coinSubtract:0,lead:[],showLeads:!1},r()(t,"objects",[]),r()(t,"splitterModel",50),r()(t,"tab","view"),r()(t,"dialog",!1),r()(t,"soTemps",[]),r()(t,"selected",{}),r()(t,"status","temp"),r()(t,"showMembership",!1),r()(t,"memberCode",null),r()(t,"showErrorInputs",!1),t},computed:{profile:function(){return this.$store.state.user.profile},list:function(){return this.$store.state.list.items},items:function(){return this.cart.map((function(t){var e={};return e.sku=t.sku,e.unit=t.unit,e.title=t.title,e.price=t.price,e.quantity=t.quantity,e.images=t.images,e.warranty=t.warranty?t.warranty:0,e.parent_id=null,e}))},tax:function(){return window.tax?window.tax.value.split(",").map((function(t){return parseInt(t)})):[0,10]},discount:function(){return 1e3*this.coinSubtract},discountPer:function(){return-1!=["abc","123","abcd","1234"].indexOf(this.coupon.toLowerCase())||-1!=["10","shop10","c10"].indexOf(this.coupon.toLowerCase())?10:-1!=["5","shop5","c5"].indexOf(this.coupon.toLowerCase())?5:void 0},coinAdd:function(){return this.getSubTotal()/1e4}},watch:{},mounted:function(){},created:function(){var t=this;t.api=new t.$api(t.collection),t.api.setDomain(t.profile.domain),t.cart=t.propCart,t.guest=t.propGuest,console.log("")},methods:{getLeadByPhone:function(t){var e=this;return c()(regeneratorRuntime.mark((function s(){var a,n,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(a=e,a.lead=[],t&&!(t.length<3)){s.next=4;break}return s.abrupt("return");case 4:return console.log(""),s.next=7,a.api.getLikePhone("contact",t);case 7:n=s.sent,i=n.data,i.count>=1&&(a.lead=i.objects),a.showLeads=!0,e.$nextTick().then((function(){console.log(a.$refs.guestPhone.focus())})),a.c.log(a.$refs.guestPhone);case 13:case"end":return s.stop()}}),s)})))()},setGuest:function(t){var e=this;this.guest=t,e.c.log(this.guest),this.lead=[],this.showLeads=!1},reset:function(){var t=this;t.cart=[],t.guest={},t.step=1,t.status="temp"},create_new:function(){var t=this;t.reset()},stepInfo:function(t){return t<=2?this.c.t("Subtotal"):t>=3?this.c.t("Total"):void 0},saveTemp:function(){var t=this;if(!t.valid())return t.showErrorInputs=!0,!1;t.status="temp";var e=t.c.genCode("SO"),s={code:e,slug:e,title:t.c.t("Sales Order")+" POS",total:t.getTotal(),cart:t.cart,contact:t.guest};t.emitParent("reloadTemp",s),t.status="ok"},removeTemp:function(t){var e=this;e.soTemps=e.soTemps.filter((function(e){return e.code!=t}))},loadTemp:function(t){var e=this;e.cart=[],e.guest={};var s=confirm("Bạn có chắc?");if(!s)return!1;console.log(""),e.cart=t.cart,e.guest=t.contact,e.$forceUpdate(),e.soTemps=e.soTemps.filter((function(e){return e.code!=t.code}))},setQuantity:function(t,e){var s=this,a=s.cart.findIndex((function(e){return e._id===t}));s.cart[a].quantity+=e,s.cart[a].quantity<0&&(s.cart[a].quantity=0),s.subTotal=s.getSubTotal(),s.$forceUpdate()},getSubTotal:function(){return this.cart.reduce((function(t,e){return t+e.price*e.quantity}),0)},getTotal:function(){var t=0,e=this.getSubTotal();return t=e,t+=this.shippingPrice>0?this.shippingPrice:0,t+=this.taxValue>0?this.taxValue*e/100:0,t-=this.discountPer>0?this.discountPer*e/100:0,t-=this.coinSubtract>0?1e3*this.coinSubtract:0,this.total=t,t},getCog:function(){var t=this,e=0;return e=t.c.sum(t.cart,"cog"),t.cog=e,e},removeItem:function(t){this.cart=this.cart.filter((function(e){return e._id!=t})),this.subTotal=this.getSubTotal(),this.emitParent("reloadRemove",this.cart)},checkCoins:function(){var t=this;t.coinSubtract>t.guest.coins&&(t.c.toast("Số coins không đủ"),t.coinSubtract=0)},valid:function(){var t=this;return t.guest.phone||t.errorInputs.push(t.c.t("Title")+" "+t.c.t("Not Empty")),t.guest.name||t.errorInputs.push(t.c.t("Name")+" "+t.c.t("Not Empty")),t.guest.province||t.errorInputs.push(t.c.t("Province")+" "+t.c.t("Not Empty")),t.guest.address||t.errorInputs.push(t.c.t("Address")+" "+t.c.t("Not Empty")),(!t.guest.email||t.guest.email&&!t.guest.email.includes("@"))&&t.errorInputs.push(t.c.t("Email")+" "+t.c.t("Error")),!(t.errorInputs.length>0)},make_order:function(){if(!this.valid())return this.showErrorInputs=!0,!1;var t=confirm("Lưu đơn hàng?");if(!t)return!1;this.save_db()},save_db:function(){var t=this,e={so:{},contact:{},items:[]},s=t.c.genCode("SO");t.cog=t.getCog();var a={code:s,slug:s,title:"Đơn hàng POS",status:"New",groupname:"POS",type:"Offline",date_created:t.c.formatDataDate(new Date),date_updated:t.c.formatDataDate(new Date),date_start:t.c.formatDataDate(new Date),total:t.total,cog:t.cog,owner:t.profile.username,coinSubtract:t.coinSubtract,coinAdd:t.coinAdd,coupon:t.coupon,shipping:t.shippingPrice,tax:t.taxValue},n=t.guest;n.cookie=localStorage.cookie?localStorage.cookie:null,n.name=t.guest.name,n.slug=t.c.genCode("CO"),n.code=n.slug,n.title=t.guest.name,n.aff=t.site.aff?t.site.aff:"online",n.source=location.href,n.type="Offline",n.date_created=t.c.formatDataDate(new Date),n.date_updated=t.c.formatDataDate(new Date),n.owner=t.profile.username,n.coins&&n.coins>0&&(n.coins=n.coins-t.coinSubtract+t.coinAdd),e.contact=n,e.so=a,e.items=t.items,console.log(""),t.loading=!0;t.api.create("so_upsert",e).then((function(e){t.c.toast("Đã lưu đơn hàng","positive"),console.log(""),t.reset(),t.loading=!1}))},fillSelected:function(t){var e=this;e.selectedIndex=t||0,e.selected=e.objects.find((function(e){return e._id==t})),e.splitterModel=50,e.tab="info",e.forceRenderer(),e.c.isMobile()?(e.dialog=!0,e.splitterModel=100):e.dialog=!1},forceRenderer:function(){this.componentKey+=1},print:function(t){var e=this.$refs[t];e&&(console.log(""),this.c.print(e))},exportCSV:function(){var t=this;t.c.exportCSV(t.fsearch,t.columns,t.collection)},emitParent:function(t,e){var s=this;s.$emit(t,e),s.$forceUpdate()}}},h=p,m=(s("0b68"),s("2877")),g=s("068f"),_=s("f531"),f=s("87fe"),v=s("4983"),b=s("58a8"),x=s("65c6"),y=s("0016"),C=s("27f9"),S=s("9c40"),q=s("2c91"),k=s("4e73"),w=s("1c1c"),T=s("66e5"),P=s("4074"),I=s("0378"),Q=s("ddd8"),$=s("b19c"),D=s("05c0"),E=s("24e8"),L=s("f09f"),M=s("6b1d"),O=s("a370"),N=s("eb85"),A=s("714f"),V=s("7f67"),U=s("eebe"),j=s.n(U),G=Object(m["a"])(h,a,n,!1,null,"757fcdda",null);e["default"]=G.exports;j()(G,"components",{QImg:g["a"],QStepper:_["a"],QStep:f["a"],QScrollArea:v["a"],QBadge:b["a"],QToolbar:x["a"],QIcon:y["a"],QInput:C["a"],QBtn:S["a"],QSpace:q["a"],QMenu:k["a"],QList:w["a"],QItem:T["a"],QItemSection:P["a"],QForm:I["a"],QSelect:Q["a"],QStepperNavigation:$["a"],QTooltip:D["a"],QDialog:E["a"],QCard:L["a"],QLinearProgress:M["a"],QCardSection:O["a"],QSeparator:N["a"]}),j()(G,"directives",{Ripple:A["a"],ClosePopup:V["a"]})}}]);