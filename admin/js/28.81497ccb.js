(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{"052e":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-layout",[t.c.canAccessModule(t.collection,t.profile.roles)?n("q-splitter",{attrs:{limits:[33,100]},scopedSlots:t._u([{key:"before",fn:function(){return[n("div",{staticStyle:{height:"100vh"}},[n("q-toolbar",[n("div",[n("div",{staticClass:" bold-font text-h5"},[t._v(t._s(t.c.t("Site Master"))+"\n                            "),t.loading?n("q-spinner-dots",{staticClass:"q-ml-sm",attrs:{color:"primary"}}):t._e()],1)]),n("q-space"),t.c.canUpdate(t.collection,t.profile.roles)?n("q-btn",{attrs:{color:"primary",flat:"","no-caps":"",icon:"post_add",label:t.c.t("New")},on:{click:function(e){return t.create()}}}):t._e()],1),n("q-separator"),n("q-toolbar",[n("q-input",{staticClass:"fit",attrs:{dense:"","bg-color":"white",outlined:"",placeholder:t.c.t("Search")+"..."},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),n("q-space"),n("q-btn",{attrs:{flat:"",round:"",icon:"refresh"},on:{click:function(e){t.search="",t.filterText="",t.getAll()}}}),t.c.canPrint(t.collection,t.profile.roles)?n("q-btn",{attrs:{flat:"",round:"",icon:"print"},on:{click:function(e){return t.print("print-list")}}}):t._e(),n("q-btn",{attrs:{flat:"",round:"",icon:"date_range"}},[n("q-menu",[n("TimeRange",{on:{reloadTimeRange:t.filterTime}})],1)],1)],1),n("q-separator"),t.showFilter?n("q-toolbar",[n("FilterBy",{attrs:{propObjects:t.filters},on:{reloadFilter:t.fillFilter}}),n("q-space")],1):t._e(),n("q-separator"),n("q-list",{attrs:{separator:""}},t._l(t.fsearch,(function(e,r){return n("q-item",{key:e._id,attrs:{clickable:"",active:r==t.selectedIndex,"active-class":"bg-info"},on:{click:function(n){t.select(e._id),t.selectedIndex=r}}},[n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{name:"home",color:"green"}})],1),n("q-item-section",[n("q-item-label",{staticClass:"bold-font text-subtitle1",attrs:{lines:"1"}},[t._v(t._s(e.title))]),n("q-item-label",{attrs:{caption:"",lines:"2"}},[t._v(t._s(e.slug))])],1),n("q-item-section",{attrs:{side:"",top:""}},[n("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.meta_robots)+"\n                            ")]),n("div",{staticClass:"row items-center"},[n("q-icon",{style:"color:"+e.color_primary,attrs:{name:"network_wifi"}}),n("q-icon",{style:"color:"+e.color_secondary,attrs:{name:"network_wifi"}}),n("q-icon",{style:"color:"+e.color_footer,attrs:{name:"network_wifi"}})],1)],1)],1)})),1),n("q-separator"),n("div",{staticClass:"q-pb-lg"},[t._v("Â ")])],1)]},proxy:!0},t.c.isMobile()?null:{key:"separator",fn:function(){return[n("q-avatar",{attrs:{color:"primary","text-color":"white",size:"28px",icon:"drag_indicator"}})]},proxy:!0},{key:"after",fn:function(){return[n("q-toolbar",[n("div",{staticClass:"row q-gutter-md"},[n("q-btn",{attrs:{flat:"","no-caps":"",color:"primary",icon:"visibility",label:t.c.t("View")},on:{click:function(e){return t.showTab("info")}}}),n("q-btn",{attrs:{flat:"","no-caps":"",color:"primary",icon:"edit",label:t.c.t("Edit or Create")},on:{click:function(e){return t.showTab("upsert")}}}),n("q-btn",{attrs:{flat:"","no-caps":"",color:"primary",icon:"task",label:t.c.t("Tasks")},on:{click:function(e){return t.showTab("task")}}})],1)]),n("q-separator"),n("div",{staticStyle:{height:"90vh"}},[n("q-tab-panels",{attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[n("q-tab-panel",{attrs:{name:"info"}},[n("q-scroll-area",{staticStyle:{height:"86vh"}},[n("Info",{key:t.componentKey,attrs:{propSelected:t.selected},on:{reloadRemove:function(e){return t.getAll()}}})],1)],1),n("q-tab-panel",{attrs:{name:"upsert"}},[n("q-scroll-area",{staticStyle:{height:"86vh"}},[t.selected?n("Upsert",{key:t.componentKey,attrs:{propSelected:t.selected},on:{reloadUpsert:t.fillUpsert}}):t._e()],1)],1),n("q-tab-panel",{attrs:{name:"task"}},[n("div",{staticClass:"text-caption"},[t._v(t._s(t.c.t("Task")))]),n("div",{staticClass:"text-h6 bold-font ellipis q-mb-md"},[t._v(t._s(t.selected.title))]),n("Task",{key:t.componentKey,attrs:{propCollection:t.collection,propId:t.selected._id}})],1)],1)],1)]},proxy:!0}],null,!0),model:{value:t.splitterModel,callback:function(e){t.splitterModel=e},expression:"splitterModel"}}):n("div",[n("div",{staticClass:"absolute-center"},[n("q-img",{attrs:{width:"25vw",src:r("5183")}}),n("div",{staticClass:"text-center q-my-lg"},[t._v(t._s(t.c.t("Access Denied")))])],1)]),n("div",{staticClass:"absolute-bottom orientation-landscape"},[n("BarStats",{key:t.componentKey,attrs:{propCount:t.fsearch.length,propSum:t.fsearch.length}})],1),n("div",{ref:"print-list",staticClass:"print-only"},[n("div",{staticClass:"text-h6"},[t._v(t._s(t.c.t("Site Master")))]),n("DataTable",{key:t.componentKey,attrs:{propData:t.fsearch,propVisibleColumns:["title","lang","owner","date_updated"]}})],1)],1)},a=[],o=r("c973"),i=r.n(o),l=(r("96cf"),r("e260"),r("d3b7"),r("e6cf"),r("3ca3"),r("ddb0"),r("4de4"),r("ac1f"),r("841c"),r("caad"),r("2532"),r("d81d"),r("7db0"),r("c740"),r("bd4c")),s={name:"ListAll",components:{TimeRange:function(){return r.e(1).then(r.bind(null,"e19d"))},FilterBy:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"2d2e"))},FilterByCategory:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"74db"))},Info:function(){return r.e(1).then(r.bind(null,"5de6"))},Upsert:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"5797"))},Task:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"43fe"))},Dot:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"9f7a"))},BarStats:function(){return Promise.all([r.e(0),r.e(2)]).then(r.bind(null,"9fda"))},DataTable:function(){return Promise.all([r.e(0),r.e(1)]).then(r.bind(null,"1fdb"))}},data:function(){return{loading:!1,c:this.$common,api:null,collection:"site",objects:[],selected:{id:null,title:null},selectedIndex:0,title:"",filterText:"",search:"",splitterModel:33,columns:[],visibleColumns:[],componentKey:0,tab:"info",timeFilter:null,filters:[],dialog:!1,showFilter:!1,page:1,offset:20}},computed:{profile:function(){return this.$store.state.user.profile},fsearch:function(){var t=this,e=t.objects;if(t.timeFilter){var r=t.timeFilter,n=new Date(r.from),a=new Date(r.to);e=e.filter((function(t){return l["b"].isBetweenDates(t.date_created,n,a)}))}t.filterText&&""!=t.filterText&&(e=e.filter((function(e){var r=t.filterText.toLowerCase(),n=e.type?e.type.toLowerCase():"",a=e.status?e.status.toLowerCase():"",o=e.category?e.category.toLowerCase():"",i=e.groupname?e.groupname.toLowerCase():"",l=e.lang?e.lang.toLowerCase():"",s=e.category_slug?e.category_slug.toLowerCase():"";return n==r||a==r||o==r||i==r||l==r||s==r})));var o=t.search.toLowerCase();return""==o?e:e.filter((function(t){var e=t.title?t.title.toLowerCase():"",r=t.code?t.code.toLowerCase():"",n=t.province?t.province.toLowerCase():"";return e.includes(o)||r.includes(o)||n.includes(o)}))}},mounted:function(){},created:function(){var t=this;t.api=new t.$api(t.collection),t.api.setDomain(t.profile.domain),t.page=1,t.offset=20,t.getAll(t.collection);var e=t.$route.params.id,r=t.$route.params.action;t.select(e,r),t.initFilter()},methods:{getAll:function(t){var e=this;return i()(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e,n.loading=!0,r.next=4,n.api.getAll(t);case 4:return a=r.sent,o=[a],r.next=8,Promise.all(o);case 8:n.loading=!1,n.objects=n.orm(a.data.objects),n.forceRenderer();case 11:case"end":return r.stop()}}),r)})))()},orm:function(t){var e=this,r=t;if(!Array.isArray(r))return[];if(r.length<=0)return[];var n=r;return n=e.c.canViewMeOnly(e.collection,e.profile.roles)?r.filter((function(t){return t.owner==e.profile.username})):r,n=n.map((function(t){var e=t;return e})),console.log(""),n||[]},initFilter:function(){var t=this;t.filters=[{key:t.collection+"-type",text:t.c.t("Type")}]},setCategory:function(t){var e=this;console.log(""),e.filterText=t&&t.title?t.title:""},select:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this,n=r.objects.length>0?r.objects.find((function(e){return e._id==t})):{};r.selected=n||r.objects[0];var a=r.objects.length>0?r.objects.findIndex((function(e){return e._id==t})):0;r.selectedIndex=a,e?r.showTab(e):r.showTab("info"),r.forceRenderer()},fillUpsert:function(t){var e=this;e.getAll(),e.select(t)},showTab:function(t){var e=this;e.tab=t,e.search="",e.filterText=""},create:function(){var t=this;t.selected={id:null,title:"",slug:""},t.selectedIndex=-1,t.tab="upsert",t.forceRenderer()},filterTime:function(t){var e=this;e.timeFilter=t},fillFilter:function(t){var e=this;e.filterText=t},forceRenderer:function(){var t=this;t.$forceUpdate(),t.componentKey+=1},print:function(t){var e=this,r=e.$refs[t];r&&(e.c.print(r),e.forceRenderer())},exportCSV:function(){var t=this;t.c.exportCSV(t.fsearch,t.columns,t.collection)}}},c=s,u=(r("89ad"),r("2877")),f=r("4d5a"),d=r("068f"),p=r("8562"),m=r("65c6"),b=r("8380"),h=r("2c91"),v=r("9c40"),y=r("eb85"),g=r("27f9"),q=r("4e73"),w=r("1c1c"),_=r("66e5"),x=r("4074"),k=r("0016"),C=r("0170"),T=r("cb32"),S=r("adad"),Q=r("823b"),I=r("4983"),L=r("eebe"),F=r.n(L),A=Object(u["a"])(c,n,a,!1,null,null,null);e["default"]=A.exports;F()(A,"components",{QLayout:f["a"],QImg:d["a"],QSplitter:p["a"],QToolbar:m["a"],QSpinnerDots:b["a"],QSpace:h["a"],QBtn:v["a"],QSeparator:y["a"],QInput:g["a"],QMenu:q["a"],QList:w["a"],QItem:_["a"],QItemSection:x["a"],QIcon:k["a"],QItemLabel:C["a"],QAvatar:T["a"],QTabPanels:S["a"],QTabPanel:Q["a"],QScrollArea:I["a"]})},"565f":function(t,e,r){},"89ad":function(t,e,r){"use strict";r("565f")}}]);