(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"013f":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100vh"}},[a("div",{staticClass:"row full-height"},[a("div",{staticClass:"col-12 col-md-7 bg-primary orientation-landscape"},[a("div",{staticStyle:{width:"60%","padding-top":"100px",margin:"auto"}},[a("q-img",{staticStyle:{width:"100%"},attrs:{src:e.c.showImage(e.ui.banner)}})],1)]),a("div",{staticClass:"col-12 col-md-5 q-pa-xl"},[a("div",{staticClass:"text-center q-mb-xl"},[a("q-img",{staticStyle:{width:"25%"},attrs:{src:e.c.showImage(e.ui.logo)}})],1),a("q-toolbar",{staticClass:"no-padding"},[a("div",{staticClass:"text-h5 bold-font"},[a("div",[e._v(e._s(e.c.t("Login")))]),e.fixedDomain?a("div",{staticClass:"text-caption text-primary"},[a("q-icon",{attrs:{name:"storage"}}),e._v(" "+e._s(e.fixedDomain?e.fixedDomain:"")+"\n                    ")],1):e._e()]),a("q-space"),a("q-icon",{staticClass:"cursor-pointer q-ml-sm",attrs:{name:"more_vert",size:"24px"}},[a("q-menu",[a("Lang",{on:{reloadLanguage:e.fillLanguage}})],1)],1)],1),a("q-separator",{staticClass:"q-my-md"}),a("q-form",{on:{submit:e.onSubmit,reset:e.onReset}},[e.fixedDomain?e._e():a("q-input",{attrs:{dense:"","stack-label":"",outlined:e.c.outlined(),label:e.c.t("Domain")+"*","lazy-rules":"",rules:e.c.valid("min-3")},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"storage"}})]},proxy:!0}],null,!1,802677397),model:{value:e.profile.domain,callback:function(t){e.$set(e.profile,"domain",t)},expression:"profile.domain"}}),a("q-input",{attrs:{dense:"","stack-label":"",outlined:e.c.outlined(),label:e.c.t("Username")+"*","lazy-rules":"",rules:e.c.valid("min-3")},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"person"}})]},proxy:!0}]),model:{value:e.profile.username,callback:function(t){e.$set(e.profile,"username",t)},expression:"profile.username"}}),a("q-input",{attrs:{dense:"","stack-label":"",outlined:e.c.outlined(),label:e.c.t("Password")+"*",type:e.isPwd?"password":"text"},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"password"}})]},proxy:!0},{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isPwd?"visibility_off":"visibility"},on:{click:function(t){e.isPwd=!e.isPwd}}})]},proxy:!0}]),model:{value:e.profile.password,callback:function(t){e.$set(e.profile,"password",t)},expression:"profile.password"}}),a("q-toggle",{staticClass:"q-mt-md",attrs:{label:e.c.t("Save on this device")},model:{value:e.saveLocal,callback:function(t){e.saveLocal=t},expression:"saveLocal"}}),a("div",{staticClass:"q-my-lg"},[a("q-btn",{staticClass:"full-width",attrs:{push:"",type:"submit",color:"primary",loading:e.loading,label:e.c.t("Login")},scopedSlots:e._u([{key:"loading",fn:function(){return[a("q-spinner-facebook")]},proxy:!0}])}),a("q-separator",{staticClass:"q-my-md"}),a("q-btn",{staticClass:"full-width",attrs:{ouline:"",label:e.c.t("Register")},on:{click:function(t){return e.c.goto("/register")}}})],1)],1)],1)])])},i=[],n=a("c973"),s=a.n(n),r=(a("96cf"),a("498a"),a("d3b7"),a("25f0"),a("b0c0"),a("e260"),a("e6cf"),a("3ca3"),a("ddb0"),a("72b2")),l=(a("1fb0"),{components:{Lang:r["default"]},data:function(){return{loading:!1,c:this.$common,api:null,collection:"user",profile:{username:"",password:"",domain:"",type:"external"},ui:{lang:"",primary:"",secondary:"",info:"",outlined:!0},saveLocal:!1,fixedDomain:null,isPwd:!0,authed:!1,list:[]}},created:function(){this.init()},methods:{init:function(){var e=this;e.api=new e.$api(e.collection);var t=e.$q.localStorage.getItem("profile"),a=e.api.ui,o=e.$q.localStorage.getItem("saveLocal");t&&(e.profile=t),a&&(e.ui=a),o&&(e.saveLocal=o),e.api.domain&&""!=e.api.domain?e.fixedDomain=e.api.domain:e.fixedDomain=null,e.profile.domain=e.fixedDomain,e.loadList()},onSubmit:function(){var e=this;return s()(regeneratorRuntime.mark((function t(){var a,o,i,n,s,r,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,a.api.setDomain(a.profile.domain),console.log(""),a.loadList(),a.loading=!0,t.next=7,a.api.getByUsername(a.collection,a.profile.username);case 7:if(o=t.sent,i=o.data,console.log(""),!i||"error"!=i.status){t.next=13;break}return a.c.toast(i.message,"negative"),t.abrupt("return");case 13:if(!(i.count<=0)){t.next=18;break}return a.c.toast(a.c.t("User not found"),"negative"),t.abrupt("return");case 18:if(n=i.objects[0],"active"==n.status.toLowerCase()){t.next=23;break}return a.c.toast(a.c.t("User not active"),"negative"),a.loading=!1,t.abrupt("return");case 23:s=n.password?n.password.toString().toLowerCase().trim():"@",r=a.profile.password?a.profile.password.toLowerCase().trim():"#",s===r?(a.orm(n),a.$store.commit("user/profile",a.profile),a.$store.commit("list/items",a.list),a.localStoreProfile("profile",a.profile),a.localStoreProfile("saveLocal",a.saveLocal),a.c.toast(a.c.t("Welcome")+"  "+a.profile.name,"positive"),l=sessionStorage.getItem("redirectPath")?sessionStorage.getItem("redirectPath"):"/",sessionStorage.removeItem("redirectPath"),a.c.goto(l)):a.c.toast(a.c.t("Wrong password"),"negative");case 26:return a.loading=!1,t.abrupt("return");case 28:case"end":return t.stop()}}),t)})))()},onReset:function(){this.profile={},this.ui={},this.isPwd=!0},orm:function(e){var t=this;t.profile._id=e._id,t.profile.email=e.email,t.profile.name=e.name,t.profile.roles=e.roles,t.profile.type=e.type},localStoreProfile:function(e,t){var a=this;a.saveLocal?a.$q.localStorage.set(e,t):a.$q.localStorage.remove(e)},loadList:function(){var e=this;e.api.getAll("list").then((function(t){if(console.log(""),t.data.count<=0)return e.loading=!1,[];e.list=t.data.objects}))},fillLanguage:function(e){var t=this;a("8488")("./"+e.value).then((function(a){t.$q.lang.set(a.default),t.$i18n.locale=e.value,t.$forceUpdate()}))}}}),c=l,u=(a("2080"),a("2877")),d=a("068f"),p=a("65c6"),f=a("0016"),m=a("2c91"),g=a("4e73"),v=a("eb85"),b=a("0378"),w=a("27f9"),h=a("9564"),q=a("9c40"),x=a("e669"),y=a("eebe"),S=a.n(y),k=Object(u["a"])(c,o,i,!1,null,"0a24eec3",null);t["default"]=k.exports;S()(k,"components",{QImg:d["a"],QToolbar:p["a"],QIcon:f["a"],QSpace:m["a"],QMenu:g["a"],QSeparator:v["a"],QForm:b["a"],QInput:w["a"],QToggle:h["a"],QBtn:q["a"],QSpinnerFacebook:x["a"]})},2080:function(e,t,a){"use strict";a("c54d")},c54d:function(e,t,a){}}]);