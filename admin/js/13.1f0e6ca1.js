(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{3447:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-layout",[t.c.canAccessModule(t.collection,t.profile.roles)?n("div",{ref:"main"},[n("q-toolbar",[n("div",[n("div",{staticClass:" bold-font text-h5"},[t._v(t._s(t.c.t("Category"))+"\n                    "),t.loading?n("q-spinner-dots",{staticClass:"q-ml-sm",attrs:{color:"primary"}}):t._e()],1)]),n("q-space"),t.c.canUpdate(t.collection,t.profile.roles)?n("q-btn",{attrs:{color:"primary",flat:"","no-caps":"",icon:"post_add",label:t.c.t("New")},on:{click:function(e){t.create(),t.dialog=!0}}}):t._e()],1),n("q-separator"),n("q-toolbar",[n("q-input",{staticClass:"fit",attrs:{dense:"","bg-color":"white",outlined:"",placeholder:t.c.t("Search")+"..."},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),n("q-space"),n("q-btn",{attrs:{flat:"",round:"",icon:"refresh"},on:{click:function(e){t.search="",t.filterText="",t.getAll()}}}),t.c.canPrint(t.collection,t.profile.roles)?n("q-btn",{attrs:{flat:"",round:"",icon:"print"},on:{click:function(e){return t.print("print-list")}}}):t._e()],1),n("q-separator"),t.showFilter?n("q-toolbar",[n("FilterBy",{attrs:{propObjects:t.filters},on:{reloadFilter:t.fillFilter}}),n("q-space"),n("FilterByCategory",{attrs:{propSlug:"system"},on:{reloadCategory:t.setCategory}})],1):t._e(),n("q-separator"),t.treeView?n("q-tree",{ref:"tree",staticClass:"q-ml-sm",attrs:{nodes:t.treeObjects,accordion:"","node-key":"_id",expanded:t.expanded,filter:t.search,selected:t.selectedKey},on:{"update:expanded":function(e){t.expanded=e},"update:selected":function(e){t.selectedKey=e}}}):n("q-list",{attrs:{separator:""}},t._l(t.getCategory("system"),(function(e,a){return n("q-expansion-item",{key:"one"+e._id,attrs:{group:"accordion","expand-separator":"",icon:e.icon?e.icon:"list_alt"},on:{click:function(a){t.select(e._id),t.dialog=!0}},scopedSlots:t._u([{key:"header",fn:function(){return[n("q-item-section",{attrs:{avatar:""}},[e.images?n("q-avatar",[n("q-img",{attrs:{round:"",src:t.c.showImage(e.images),size:"sm"}})],1):n("q-icon",{attrs:{name:e.icon?e.icon:"list_alt",size:"sm"}})],1),n("q-item-section",[n("div",{staticClass:"bold-font text-subtitle1"},[t._v(t._s(e.title)+"\n                            "),n("q-badge",{attrs:{color:"info"}},[t._v(t._s(t.getCategory(e.slug).length))])],1),n("div",{staticClass:"text-caption"},[t._v(t._s(e.slug))])]),n("q-item-section",{attrs:{side:""}})]},proxy:!0}],null,!0)},t._l(t.getCategory(e.slug),(function(e,a){return n("div",[t.getCategory(e.slug).length>0?n("div",[n("q-expansion-item",{key:"sub2"+e._id,attrs:{group:"sub3","expand-separator":"",icon:e.icon?e.icon:"list_alt"},on:{click:function(a){t.select(e._id),t.dialog=!0}},scopedSlots:t._u([{key:"header",fn:function(){return[n("q-item-section",{attrs:{avatar:""}}),n("q-item-section",{attrs:{avatar:""}},[e.images?n("q-avatar",[n("q-img",{attrs:{src:t.c.showImage(e.images),size:"sm"}})],1):n("q-icon",{attrs:{name:e.icon?e.icon:"list_alt",size:"sm"}})],1),n("q-item-section",[n("div",{staticClass:"bold-font text-subtitle1"},[t._v(t._s(e.title)+" "),n("q-badge",{attrs:{color:"info"}},[t._v(t._s(t.getCategory(e.slug).length))])],1),n("div",{staticClass:"text-caption"},[t._v(t._s(e.url))])]),n("q-item-section",{attrs:{side:""}})]},proxy:!0}],null,!0)},t._l(t.getCategory(e.slug),(function(e,a){return n("q-item",{key:"three"+e._id,attrs:{clickable:"",active:a==t.selectedIndex,"active-class":""},on:{click:function(n){t.select(e._id),t.selectedIndex=a,t.dialog=!0}}},[n("q-item-section",{attrs:{avatar:""}}),n("q-item-section",{attrs:{avatar:""}}),n("q-item-section",{attrs:{avatar:""}},[e.images?n("q-avatar",[n("q-img",{attrs:{src:t.c.showImage(e.images),size:"sm"}})],1):n("q-icon",{attrs:{name:e.icon?e.icon:"list_alt",size:"sm"}})],1),n("q-item-section",[n("q-item-label",{staticClass:"bold-font text-subtitle1",attrs:{lines:"1"}},[t._v(t._s(e.title)+"\n                                    ")]),n("q-item-label",{attrs:{caption:"",lines:"2"}},[t._v(t._s(e.url))])],1)],1)})),1)],1):n("div",[n("q-item",{attrs:{clickable:"",active:a==t.selectedIndex,"active-class":""},on:{click:function(n){t.select(e._id),t.selectedIndex=a,t.dialog=!0}}},[n("q-item-section",{attrs:{avatar:""}}),n("q-item-section",{attrs:{avatar:""}},[e.images?n("q-avatar",[n("q-img",{attrs:{src:t.c.showImage(e.images),size:"sm"}})],1):n("q-icon",{attrs:{name:e.icon?e.icon:"list_alt",size:"sm"}})],1),n("q-item-section",[n("q-item-label",{staticClass:"bold-font text-subtitle1",attrs:{lines:"1"}},[t._v(t._s(e.title)+"\n                                ")]),n("q-item-label",{attrs:{caption:"",lines:"2"}},[t._v(t._s(e.url))])],1)],1)],1)])})),0)})),1),n("q-separator"),n("div",{staticClass:"q-pb-lg"},[t._v(" ")])],1):n("div",[n("div",{staticClass:"absolute-center"},[n("q-img",{attrs:{width:"25vw",src:a("5183")}}),n("div",{staticClass:"text-center q-my-lg"},[t._v(t._s(t.c.t("Access Denied")))])],1)]),n("q-dialog",{ref:"popup",staticClass:"q-pb-lg",attrs:{position:"bottom"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("div",{staticClass:"bg-white",staticStyle:{height:"80vh"}},[n("q-toolbar",[n("div",{staticClass:"row"},[n("q-btn",{attrs:{flat:"","no-caps":"",color:"primary",icon:"visibility",label:t.c.t("View")},on:{click:function(e){return t.showTab("info")}}}),n("q-btn",{attrs:{flat:"","no-caps":"",color:"primary",icon:"edit",label:t.c.t("Edit or Create")},on:{click:function(e){return t.showTab("upsert")}}}),n("q-btn",{attrs:{flat:"","no-caps":"",color:"primary",icon:"task",label:t.c.t("Tasks")},on:{click:function(e){return t.showTab("task")}}})],1)]),n("q-separator"),n("q-tab-panels",{attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[n("q-tab-panel",{attrs:{name:"info"}},[n("Info",{key:t.componentKey,attrs:{propSelected:t.selected},on:{reloadRemove:function(e){return t.getAll()}}})],1),n("q-tab-panel",{attrs:{name:"upsert"}},[t.selected?n("Upsert",{key:t.componentKey,attrs:{propSelected:t.selected},on:{reloadUpsert:t.fillUpsert}}):t._e()],1),n("q-tab-panel",{attrs:{name:"task"}},[n("div",{staticClass:"text-caption"},[t._v(t._s(t.c.t("Task")))]),n("div",{staticClass:"text-h6 bold-font ellipis q-mb-md"},[t._v(t._s(t.selected.title))]),n("Task",{key:t.componentKey,attrs:{propCollection:t.collection,propId:t.selected._id}})],1)],1)],1)]),n("div",{staticClass:"absolute-bottom "},[n("q-separator"),n("BarStats",{key:t.componentKey,attrs:{propCount:t.fsearch.length,propSum:t.fsearch.length}})],1),n("div",{ref:"print-list",staticClass:"print-only"},[n("div",{staticClass:"text-h6"},[t._v(t._s(t.c.t("Category")))]),n("DataTable",{key:t.componentKey,attrs:{propData:t.fsearch,propVisibleColumns:["title","lang","owner","date_updated"]}})],1)],1)},i=[],r=(a("e260"),a("d3b7"),a("e6cf"),a("3ca3"),a("ddb0"),a("4de4"),a("ac1f"),a("841c"),a("caad"),a("2532"),a("4e82"),a("d81d"),a("7db0"),a("c740"),a("bd4c")),s={name:"ListAll",components:{TimeRange:function(){return a.e(1).then(a.bind(null,"e19d"))},FilterBy:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"2d2e"))},FilterByCategory:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"74db"))},Info:function(){return a.e(1).then(a.bind(null,"2cfc"))},Upsert:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"3380"))},Task:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"43fe"))},Dot:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"9f7a"))},BarStats:function(){return Promise.all([a.e(0),a.e(2)]).then(a.bind(null,"9fda"))},DataTable:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"1fdb"))}},data:function(){return{loading:!1,c:this.$common,api:null,collection:"category",objects:[],selected:{id:null,title:null},selectedIndex:0,title:"",filterText:"",search:"",splitterModel:33,columns:[],visibleColumns:[],componentKey:0,tab:"info",timeFilter:null,filters:[],dialog:!1,showFilter:!1,page:1,offset:20,treeObjects:[],selectedKey:"",expanded:["System","Bài viết Blog"],treeView:!1}},computed:{profile:function(){return this.$store.state.user.profile},fsearch:function(){var t=this,e=t.objects;if(t.timeFilter){var a=t.timeFilter,n=new Date(a.from),i=new Date(a.to);e=e.filter((function(t){return r["b"].isBetweenDates(t.date_created,n,i)}))}t.filterText&&""!=t.filterText&&(e=e.filter((function(e){var a=t.filterText.toLowerCase(),n=e.type?e.type.toLowerCase():"",i=e.status?e.status.toLowerCase():"",r=e.category?e.category.toLowerCase():"",s=e.groupname?e.groupname.toLowerCase():"",o=e.lang?e.lang.toLowerCase():"",l=e.parent_slug?e.parent_slug.toLowerCase():"",c=e.parent_title?e.parent_title.toLowerCase():"";return n==a||i==a||r==a||s==a||o==a||l==a||c==a})));var s=t.search.toLowerCase();return""==s?e:e.filter((function(t){var e=t.title?t.title.toLowerCase():"",a=t.parent_title?t.parent_title.toLowerCase():"",n=t.slug?t.slug.toLowerCase():"";return e.includes(s)||a.includes(s)||n.includes(s)}))}},mounted:function(){},created:function(){var t=this;t.api=new t.$api(t.collection),t.api.setDomain(t.profile.domain),t.page=1,t.offset=20,t.getAll(),t.initFilter()},methods:{getAll:function(){var t=this;t.loading=!0,t.api.getAll(t.collection).then((function(e){if(console.log(""),e.data.count<=0)t.loading=!1;else{t.objects=t.orm(e.data.objects),t.objects.sort((function(t,e){return t.doc_order<e.doc_order?1:t.doc_order>e.doc_order?-1:0}));var a=t.$route.params.id,n=t.$route.params.action;t.select(a,n),t.loading=!1,t.forceRenderer()}}))},orm:function(t){var e=this,a=t;if(!Array.isArray(a))return[];if(a.length<=0)return[];var n=a;return n=e.c.canViewMeOnly(e.collection,e.profile.roles)?a.filter((function(t){return t.owner==e.profile.username})):a,n=n.map((function(t){var e=t;return e.parent_id=t.parent_id?t.parent_id:null,e.children=t.children?t.children:[],e})),console.log(""),n||[]},initFilter:function(){var t=this;t.filters=[{key:"cms-status",text:t.c.t("Status")},{key:"lang",text:t.c.t("Language")}]},getCategory:function(t){var e=this;if(!t)return[];var a=e.objects,n=a.filter((function(e){return e.parent_slug==t})),i=e.search.toLowerCase();return""==i?n:n.filter((function(t){var e=t.title?t.title.toLowerCase():"",a=t.parent_title?t.parent_title.toLowerCase():"",n=t.slug?t.slug.toLowerCase():"";return e.includes(i)||a.includes(i)||n.includes(i)}))},setCategory:function(t){var e=this;console.log(""),e.filterText=t&&t.slug?t.slug:""},select:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this,n=a.objects.length>0?a.objects.find((function(e){return e._id==t})):{};a.selected=n||a.objects[0];var i=a.objects.length>0?a.objects.findIndex((function(e){return e._id==t})):0;a.selectedIndex=i,e?a.showTab(e):a.showTab("info"),a.forceRenderer()},fillUpsert:function(t){var e=this;e.getAll(),e.select(t)},showTab:function(t){var e=this;e.tab=t,e.search="",e.filterText=""},create:function(){var t=this;t.selected={id:null,title:"",slug:""},t.selectedIndex=-1,t.tab="upsert",t.forceRenderer()},filterTime:function(t){var e=this;e.timeFilter=t},fillFilter:function(t){var e=this;e.filterText=t},forceRenderer:function(){var t=this;t.$forceUpdate(),t.componentKey+=1},print:function(t){var e=this,a=e.$refs[t];a&&(e.c.print(a),e.forceRenderer())},exportCSV:function(){var t=this;t.c.exportCSV(t.fsearch,t.columns,t.collection)}}},o=s,l=(a("edfe"),a("2877")),c=a("4d5a"),d=a("068f"),u=a("65c6"),f=a("8380"),p=a("2c91"),m=a("9c40"),g=a("eb85"),b=a("27f9"),v=a("4e73"),h=a("7f41"),_=a("1c1c"),q=a("3b73"),y=a("4074"),C=a("cb32"),w=a("0016"),x=a("58a8"),k=a("66e5"),T=a("0170"),I=a("24e8"),L=a("adad"),Q=a("823b"),S=a("eebe"),j=a.n(S),F=Object(l["a"])(o,n,i,!1,null,null,null);e["default"]=F.exports;j()(F,"components",{QLayout:c["a"],QImg:d["a"],QToolbar:u["a"],QSpinnerDots:f["a"],QSpace:p["a"],QBtn:m["a"],QSeparator:g["a"],QInput:b["a"],QMenu:v["a"],QTree:h["a"],QList:_["a"],QExpansionItem:q["a"],QItemSection:y["a"],QAvatar:C["a"],QIcon:w["a"],QBadge:x["a"],QItem:k["a"],QItemLabel:T["a"],QDialog:I["a"],QTabPanels:L["a"],QTabPanel:Q["a"]})},be3e:function(t,e,a){},edfe:function(t,e,a){"use strict";a("be3e")}}]);