(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[33],{"4a2f":function(e,t,a){},"7fc6":function(e,t,a){"use strict";a("4a2f")},bcb8:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("q-layout",[e.c.canAccessModule(e.collection,e.profile.roles)?l("q-splitter",{attrs:{limits:[33,100]},scopedSlots:e._u([{key:"before",fn:function(){return[l("div",{staticStyle:{height:"100vh"}},[l("q-toolbar",[l("div",[l("div",{staticClass:" bold-font text-h5"},[e._v(e._s(e.c.t("Upload"))+"\n                            "),e.loading?l("q-spinner-dots",{staticClass:"q-ml-sm",attrs:{color:"primary"}}):e._e()],1)]),l("q-space"),e.c.canUpdate(e.collection,e.profile.roles)?l("q-btn",{attrs:{color:"primary",flat:"","no-caps":"",icon:"attach_file",label:e.c.t("Upload")},on:{click:function(t){return e.create()}}}):e._e()],1),l("q-separator"),l("q-toolbar",[l("q-input",{staticClass:"fit",attrs:{dense:"","bg-color":"white",outlined:"",placeholder:e.c.t("Search")+"..."},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),l("q-space"),l("q-btn",{attrs:{flat:"",round:"",icon:"refresh"},on:{click:function(t){e.search="",e.filterText="",e.getAll()}}}),e.c.canPrint(e.collection,e.profile.roles)?l("q-btn",{attrs:{flat:"",round:"",icon:"print"},on:{click:function(t){return e.print("print-list")}}}):e._e()],1),l("q-separator"),e.showFilter?l("q-toolbar",[l("FilterBy",{attrs:{propObjects:e.filters},on:{reloadFilter:e.fillFilter}}),l("q-space")],1):e._e(),l("q-separator"),l("q-list",{attrs:{separator:""}},e._l(e.fsearch,(function(t,a){return l("q-item",{key:t._id,attrs:{clickable:"",active:a==e.selectedIndex,"active-class":"bg-info"},on:{click:function(l){e.select(t),e.selectedIndex=a}}},[l("q-item-section",{attrs:{avatar:""}},[l("q-icon",{attrs:{name:"photo",color:"green"}})],1),l("q-item-section",[l("q-item-label",{staticClass:"bold-font text-subtitle1",attrs:{lines:"1"}},[e._v(e._s(t.title))]),l("q-item-label",{attrs:{caption:"",lines:"2"}},[e._v(e._s(t.slug))])],1)],1)})),1),l("q-separator"),l("div",{staticClass:"q-pb-lg"},[e._v("Â ")])],1)]},proxy:!0},e.c.isMobile()?null:{key:"separator",fn:function(){return[l("q-avatar",{attrs:{color:"primary","text-color":"white",size:"28px",icon:"drag_indicator"}})]},proxy:!0},{key:"after",fn:function(){return[l("q-toolbar",[l("div",{staticClass:"row q-gutter-md"},[l("q-btn",{attrs:{flat:"","no-caps":"",color:"primary",icon:"visibility",label:e.c.t("View")},on:{click:function(t){return e.showTab("info")}}}),l("q-btn",{attrs:{flat:"","no-caps":"",color:"primary",icon:"attach_file",label:e.c.t("Upload")},on:{click:function(t){return e.showTab("upsert")}}}),l("q-btn",{attrs:{flat:"","no-caps":"",color:"primary",icon:"task",label:e.c.t("Tasks")},on:{click:function(t){return e.showTab("task")}}})],1)]),l("q-separator"),l("div",{staticStyle:{height:"90vh"}},[l("q-tab-panels",{attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[l("q-tab-panel",{attrs:{name:"info"}},[l("q-scroll-area",{staticStyle:{height:"86vh"}},[l("Info",{key:e.componentKey,attrs:{propSelected:e.selected},on:{reloadRemove:function(t){return e.getAll()}}})],1)],1),l("q-tab-panel",{attrs:{name:"upsert"}},[l("q-scroll-area",{staticStyle:{height:"86vh"}},[e.c.canUpdate(e.collection,e.profile.roles)?l("div",[l("div",{staticClass:"bold-font text-h5 q-my-md"},[e._v(e._s(e.c.t("Upload")))]),l("q-uploader",{staticClass:"full-width",attrs:{flat:"",bordered:"","text-color":"grey-7",color:"grey-2",factory:e.upload,label:e.c.t("Images"),accept:".jpg,.jpeg,.png,.gif,.svg,.pdf,image/*","max-file-size":"2097152","field-name":"uploadfile","form-fields":[{name:"module",value:e.collection}]},on:{uploaded:e.handleUploaded,failed:e.handleFailed},model:{value:e.selected.images,callback:function(t){e.$set(e.selected,"images",t)},expression:"selected.images"}})],1):e._e()])],1),l("q-tab-panel",{attrs:{name:"task"}},[l("div",{staticClass:"text-caption"},[e._v(e._s(e.c.t("Task")))]),l("div",{staticClass:"text-h6 bold-font ellipis q-mb-md"},[e._v(e._s(e.selected.title))]),l("Task",{key:e.componentKey,attrs:{propCollection:e.collection,propId:e.selected._id}})],1)],1)],1)]},proxy:!0}],null,!0),model:{value:e.splitterModel,callback:function(t){e.splitterModel=t},expression:"splitterModel"}}):l("div",[l("div",{staticClass:"absolute-center"},[l("q-img",{attrs:{width:"25vw",src:a("5183")}}),l("div",{staticClass:"text-center q-my-lg"},[e._v(e._s(e.c.t("Access Denied")))])],1)]),l("div",{staticClass:"absolute-bottom"},[l("BarStats",{key:e.componentKey,attrs:{propCount:e.fsearch.length,propSum:e.fsearch.length}})],1),l("div",{ref:"print-list",staticClass:"print-only"},[l("div",{staticClass:"text-h6"},[e._v(e._s(e.c.t("Pages")))]),l("DataTable",{key:e.componentKey,attrs:{propData:e.fsearch,propVisibleColumns:["title","lang","owner","date_updated"]}})],1)],1)},o=[],n=(a("e260"),a("d3b7"),a("e6cf"),a("3ca3"),a("ddb0"),a("4de4"),a("ac1f"),a("841c"),a("caad"),a("2532"),a("5319"),a("d81d"),a("99af"),a("bd4c")),i={name:"ListAll",components:{TimeRange:function(){return a.e(1).then(a.bind(null,"e19d"))},FilterBy:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"2d2e"))},FilterByCategory:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"74db"))},Info:function(){return a.e(5).then(a.bind(null,"1297"))},Task:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"43fe"))},Dot:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"9f7a"))},BarStats:function(){return Promise.all([a.e(0),a.e(2)]).then(a.bind(null,"9fda"))},DataTable:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"1fdb"))}},data:function(){return{loading:!1,c:this.$common,api:null,collection:"upload",objects:[],selected:{id:null,title:null},selectedIndex:0,title:"",filterText:"",search:"",splitterModel:33,columns:[],visibleColumns:[],componentKey:0,tab:"info",timeFilter:null,filters:[],dialog:!1,showFilter:!1,page:1,offset:20}},computed:{profile:function(){return this.$store.state.user.profile},fsearch:function(){var e=this,t=e.objects;if(e.timeFilter){var a=e.timeFilter,l=new Date(a.from),o=new Date(a.to);t=t.filter((function(e){return n["b"].isBetweenDates(e.date_created,l,o)}))}e.filterText&&""!=e.filterText&&(t=t.filter((function(t){var a=e.filterText.toLowerCase(),l=t.type?t.type.toLowerCase():"",o=t.status?t.status.toLowerCase():"",n=t.category?t.category.toLowerCase():"",i=t.groupname?t.groupname.toLowerCase():"",r=t.lang?t.lang.toLowerCase():"",s=t.category_slug?t.category_slug.toLowerCase():"";return l==a||o==a||n==a||i==a||r==a||s==a})));var i=e.search.toLowerCase();return""==i?t:t.filter((function(e){var t=e.title?e.title.toLowerCase():"",a=e.slug?e.slug.toLowerCase():"";return t.includes(i)||a.includes(i)}))}},mounted:function(){},created:function(){var e=this;e.api=new e.$api(e.collection),e.api.setDomain(e.profile.domain),e.page=1,e.offset=20,e.getAll(e.collection),e.initFilter()},methods:{getAll:function(e){var t=this;t.loading=!0,t.api.getUpload(e).then((function(e){console.log(""),e.data.count<=0||(t.objects=e.data,t.objects&&t.objects.length>0&&(t.objects=t.mapAll(t.objects)),console.clear(),console.log(""),t.selectedIndex=0,t.selected=t.objects[0]),t.loading=!1}))},orm:function(e){var t=this,a={};return e&&(a._id=e.replace("./images/",""),a.title=e.replace("./images/",""),a.slug=t.api.web+e.replace("./","/")),a},mapAll:function(e){var t=this;return e.map((function(e){return t.orm(e)}))},initFilter:function(){var e=this;e.filters=[{key:"cms-status",text:e.c.t("Status")},{key:"lang",text:e.c.t("Language")}]},setCategory:function(e){var t=this;console.log(""),t.filterText=e&&e.title?e.title:""},select:function(e){var t=this;t.selected=e,t.forceRenderer()},showTab:function(e){var t=this;t.tab=e,t.search="",t.filterText=""},create:function(){var e=this;e.selected={id:null,title:"",slug:""},e.selectedIndex=-1,e.tab="upsert",e.forceRenderer()},upload:function(e){var t=this,a=t.api.web+"/v1/admin/uploadfiles";return new Promise((function(e,t){e({url:a,method:"POST"})}))},handleUploaded:function(e){var t=this;this.c.log(e.xhr.response);var a=JSON.parse(e.xhr.response),l="".concat(t.api.web,"/images/").concat(a.filename);this.c.log(l),t.selected.images=l,t.c.toast(t.c.t("Upload finished"),"positive"),t.getAll()},handleFailed:function(e){this.c.log(e.xhr.response);JSON.parse(e.xhr.response);vm.c.toast(vm.c.t("Upload error"),"negative")},filterTime:function(e){var t=this;t.timeFilter=e},fillFilter:function(e){var t=this;t.filterText=e},forceRenderer:function(){var e=this;e.$forceUpdate(),e.componentKey+=1},print:function(e){var t=this,a=t.$refs[e];a&&(t.c.print(a),t.forceRenderer())},exportCSV:function(){var e=this;e.c.exportCSV(e.fsearch,e.columns,e.collection)}}},r=i,s=(a("7fc6"),a("2877")),c=a("4d5a"),d=a("068f"),u=a("8562"),p=a("65c6"),f=a("8380"),m=a("2c91"),b=a("9c40"),h=a("eb85"),g=a("27f9"),v=a("4e73"),y=a("1c1c"),q=a("66e5"),x=a("4074"),w=a("0016"),_=a("0170"),C=a("b047"),k=a("cb32"),T=a("adad"),S=a("823b"),Q=a("4983"),F=a("ee89"),I=a("eebe"),L=a.n(I),U=Object(s["a"])(r,l,o,!1,null,null,null);t["default"]=U.exports;L()(U,"components",{QLayout:c["a"],QImg:d["a"],QSplitter:u["a"],QToolbar:p["a"],QSpinnerDots:f["a"],QSpace:m["a"],QBtn:b["a"],QSeparator:h["a"],QInput:g["a"],QMenu:v["a"],QList:y["a"],QItem:q["a"],QItemSection:x["a"],QIcon:w["a"],QItemLabel:_["a"],QChip:C["a"],QAvatar:k["a"],QTabPanels:T["a"],QTabPanel:S["a"],QScrollArea:Q["a"],QUploader:F["a"]})}}]);